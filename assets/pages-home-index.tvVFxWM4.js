var e=(e,a,l)=>new Promise((s,u)=>{var t=e=>{try{o(l.next(e))}catch(a){u(a)}},n=e=>{try{o(l.throw(e))}catch(a){u(a)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(t,n);o((l=l.apply(e,a)).next())});import{r as a,o as l,c as s,w as u,a as t,I as n,i as o,b as c,F as d,d as r,e as i,t as f,f as v,g as _,h as m,O as h,j as p,k as g,n as z,l as y}from"./index-DvadhCu2.js";import{_ as b,s as k,g as w,a as C,f as x,b as j,c as E}from"./_plugin-vue_export-helper.CQNFGRkO.js";import{H as I,d as N}from"./common.DOXCbTgk.js";const O=b({__name:"index",emits:["refresh","search-results"],setup(_,{emit:m}){const h=m,p=a(),g=a([]),z=a(!1),y=a(null),b=N(()=>e(this,null,function*(){if(!p.value)return z.value=!1,void h("search-results",[]);if(p.value.length<3)return z.value=!1,void h("search-results",[]);const e=yield k(p.value);g.value=e,z.value=!0,h("search-results",e)}),500),w=()=>{b()},C=()=>{h("refresh")};return(e,a)=>{const _=n,m=o;return l(),s(m,{class:"search"},{default:u(()=>[t(_,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),placeholder:"请输入至少3位基金代码/名称",onInput:w},null,8,["modelValue"]),z.value?(l(),s(m,{key:0,class:"dropdown"},{default:u(()=>[(l(!0),c(d,null,r(g.value,e=>(l(),s(m,{key:e.CODE,class:"option",onClick:a=>(e=>{var a;z.value=!1,p.value=e.NAME,null==(a=y.value)||a.open(e.CODE)})(e)},{default:u(()=>[i(f(e.CODE)+" - "+f(e.NAME),1)]),_:2},1032,["onClick"]))),128))]),_:1})):v("",!0),t(I,{ref_key:"holderSelectorRef",ref:y,onConfirm:C},null,512)]),_:1})}}},[["__scopeId","data-v-16a38c40"]]),D=(e=>(a,l=m())=>{!p&&_(e,a,l)})(h),V=b({__name:"index",setup(n){const _=a([]),m=()=>e(this,null,function*(){if(!I.value.length)return void(_.value=[]);const e=yield j(I.value.map(e=>e.code));_.value=e.map((e,a)=>e.fundcode?{code:e.fundcode,name:e.name,gsz:e.gsz,dwjz:e.dwjz,gszzl:e.gszzl,gztime:e.gztime}:{code:I.value[a].code,name:"--",gszzl:"--"})}),h=a({}),p=()=>e(this,null,function*(){const e=yield x();h.value=e,m()}),b=a(),k=a([]),I=g(()=>h.value[b.value]||[]),N=()=>e(this,null,function*(){const e=yield w();if(k.value=e||[],!b.value){const e=yield C();b.value=e}p()});return D(()=>{console.log("onShow"),N()}),(e,a)=>{const n=o,h=y;return l(),s(n,{class:"page"},{default:u(()=>[t(n,{class:"header"},{default:u(()=>[t(n,{class:"holder-tabs"},{default:u(()=>[(l(!0),c(d,null,r(k.value,e=>(l(),s(n,{key:e.id,class:z(["tab",{active:b.value===e.id}]),onClick:a=>{return l=e.id,b.value=l,E(l),void m();var l}},{default:u(()=>[i(f(e.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),t(n,{class:"header-top"},{default:u(()=>[t(h,{class:"title"},{default:u(()=>[i("实时估值")]),_:1}),t(n,{class:"refresh-btn",onClick:m},{default:u(()=>[i(" 刷新 ")]),_:1})]),_:1}),t(O,{onRefresh:N})]),_:1}),t(n,{class:"list"},{default:u(()=>[(l(!0),c(d,null,r(_.value,e=>(l(),s(n,{key:e.code,class:"card"},{default:u(()=>[t(n,{class:"row top"},{default:u(()=>[t(n,null,{default:u(()=>[t(n,{class:"name"},{default:u(()=>[i(f(e.name),1)]),_:2},1024),t(n,{class:"code"},{default:u(()=>[i(f(e.code),1)]),_:2},1024)]),_:2},1024),t(n,{class:z(["change",Number(e.gszzl)>=0?"up":"down"])},{default:u(()=>{return[i(f((a=e.gszzl,"--"===a?"--":Number(a).toFixed(2)+"%")),1)];var a}),_:2},1032,["class"])]),_:2},1024),t(n,{class:"row bottom"},{default:u(()=>[t(n,{class:"col"},{default:u(()=>[t(h,{class:"label"},{default:u(()=>[i("估算")]),_:1}),t(h,{class:"value"},{default:u(()=>[i(f(e.gsz||"--"),1)]),_:2},1024)]),_:2},1024),t(n,{class:"col"},{default:u(()=>[t(h,{class:"label"},{default:u(()=>[i("净值")]),_:1}),t(h,{class:"value"},{default:u(()=>[i(f(e.dwjz||"--"),1)]),_:2},1024)]),_:2},1024),t(n,{class:"time"},{default:u(()=>[i(f(e.gztime||"--"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),_.value.length?v("",!0):(l(),s(n,{key:0,class:"empty"},{default:u(()=>[i(" 暂无基金 ")]),_:1}))]),_:1})]),_:1})}}},[["__scopeId","data-v-abb5681b"]]);export{V as default};
