import{r as a,o as e,c as l,w as s,a as u,I as t,i as c,b as o,F as d,d as n,e as r,t as f,f as v,g as i,h as _,O as m,j as p,k as h,n as g,l as z}from"./index-BKM0h8wX.js";import{_ as w,s as b,g as k,a as y,f as C,b as j,c as x}from"./_plugin-vue_export-helper.CMYti9f6.js";import{H as E,d as I}from"./common.C_t86p82.js";const N=w({__name:"index",emits:["refresh","search-results"],setup(i,{emit:_}){const m=_,p=a(),h=a([]),g=a(!1),z=a(null),w=I(async()=>{if(!p.value)return g.value=!1,void m("search-results",[]);if(p.value.length<3)return g.value=!1,void m("search-results",[]);const a=await b(p.value);h.value=a,g.value=!0,m("search-results",a)},500),k=()=>{w()},y=()=>{m("refresh")};return(a,i)=>{const _=t,m=c;return e(),l(m,{class:"search"},{default:s(()=>[u(_,{modelValue:p.value,"onUpdate:modelValue":i[0]||(i[0]=a=>p.value=a),placeholder:"请输入至少3位基金代码/名称",onInput:k},null,8,["modelValue"]),g.value?(e(),l(m,{key:0,class:"dropdown"},{default:s(()=>[(e(!0),o(d,null,n(h.value,a=>(e(),l(m,{key:a.CODE,class:"option",onClick:e=>(a=>{var e;g.value=!1,p.value=a.NAME,null==(e=z.value)||e.open(a.CODE)})(a)},{default:s(()=>[r(f(a.CODE)+" - "+f(a.NAME),1)]),_:2},1032,["onClick"]))),128))]),_:1})):v("",!0),u(E,{ref_key:"holderSelectorRef",ref:z,onConfirm:y},null,512)]),_:1})}}},[["__scopeId","data-v-16a38c40"]]),O=(a=>(e,l=_())=>{!p&&i(a,e,l)})(m),D=w({__name:"index",setup(t){const i=a([]),_=async()=>{if(!b.value.length)return void(i.value=[]);const a=await j(b.value.map(a=>a.code));i.value=a.map((a,e)=>a.fundcode?{code:a.fundcode,name:a.name,gsz:a.gsz,dwjz:a.dwjz,gszzl:a.gszzl,gztime:a.gztime}:{code:b.value[e].code,name:"--",gszzl:"--"})},m=a({}),p=a(),w=a([]),b=h(()=>m.value[p.value]||[]),E=async()=>{const a=await k();if(w.value=a||[],!p.value){const a=await y();p.value=a}(async()=>{const a=await C();m.value=a,_()})()};return O(()=>{console.log("onShow"),E()}),(a,t)=>{const m=c,h=z;return e(),l(m,{class:"page"},{default:s(()=>[u(m,{class:"header"},{default:s(()=>[u(m,{class:"holder-tabs"},{default:s(()=>[(e(!0),o(d,null,n(w.value,a=>(e(),l(m,{key:a.id,class:g(["tab",{active:p.value===a.id}]),onClick:e=>{return l=a.id,p.value=l,x(l),void _();var l}},{default:s(()=>[r(f(a.name),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),u(m,{class:"header-top"},{default:s(()=>[u(h,{class:"title"},{default:s(()=>[r("实时估值")]),_:1}),u(m,{class:"refresh-btn",onClick:_},{default:s(()=>[r(" 刷新 ")]),_:1})]),_:1}),u(N,{onRefresh:E})]),_:1}),u(m,{class:"list"},{default:s(()=>[(e(!0),o(d,null,n(i.value,a=>(e(),l(m,{key:a.code,class:"card"},{default:s(()=>[u(m,{class:"row top"},{default:s(()=>[u(m,null,{default:s(()=>[u(m,{class:"name"},{default:s(()=>[r(f(a.name),1)]),_:2},1024),u(m,{class:"code"},{default:s(()=>[r(f(a.code),1)]),_:2},1024)]),_:2},1024),u(m,{class:g(["change",Number(a.gszzl)>=0?"up":"down"])},{default:s(()=>{return[r(f((e=a.gszzl,"--"===e?"--":Number(e).toFixed(2)+"%")),1)];var e}),_:2},1032,["class"])]),_:2},1024),u(m,{class:"row bottom"},{default:s(()=>[u(m,{class:"col"},{default:s(()=>[u(h,{class:"label"},{default:s(()=>[r("估算")]),_:1}),u(h,{class:"value"},{default:s(()=>[r(f(a.gsz||"--"),1)]),_:2},1024)]),_:2},1024),u(m,{class:"col"},{default:s(()=>[u(h,{class:"label"},{default:s(()=>[r("净值")]),_:1}),u(h,{class:"value"},{default:s(()=>[r(f(a.dwjz||"--"),1)]),_:2},1024)]),_:2},1024),u(m,{class:"time"},{default:s(()=>[r(f(a.gztime||"--"),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),i.value.length?v("",!0):(e(),l(m,{key:0,class:"empty"},{default:s(()=>[r(" 暂无基金 ")]),_:1}))]),_:1})]),_:1})}}},[["__scopeId","data-v-abb5681b"]]);export{D as default};
